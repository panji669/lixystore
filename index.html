<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>LIXY Store</title>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet">

<style>
  :root{
    --bg:#0f1115; --bg2:#151820;
    --card:#181c26; --card2:#1e2330;
    --text:#eef2f7; --muted:#9aa3b2;
    --accent:#39ffb4; --accent2:#12d0ff;
    --danger:#ff5b5b; --line:rgba(255,255,255,.08);
    --radius:14px; --shadow:0 8px 24px rgba(0,0,0,.45);
  }
  *{box-sizing:border-box}
  body{
    margin:0; font-family:Poppins,sans-serif; color:var(--text);
    background:
      radial-gradient(900px 500px at 10% -10%, #1c2334 0%, transparent 55%),
      radial-gradient(800px 500px at 110% 0%, #1a1524 0%, transparent 60%),
      var(--bg);
    min-height:100vh;
  }
  button{font-family:inherit; cursor:pointer}

  .hidden{display:none!important}
  .page{max-width:1100px;margin:0 auto;padding:16px 16px 110px; animation:fade .25s ease}
  @keyframes fade{from{opacity:0;transform:translateY(6px)}to{opacity:1;transform:none}}

  /* Splash */
  #splash{height:100vh;display:grid;place-items:center;text-align:center;padding:20px}
  .splash-card{
    width:min(460px,100%); background:rgba(255,255,255,.04);
    border:1px solid var(--line); border-radius:22px; padding:22px;
    box-shadow:var(--shadow);
  }
  .logo{
    width:120px;height:120px;border-radius:50%;overflow:hidden;
    margin:0 auto 12px;border:3px solid #fff;
  }
  .logo img{width:100%;height:100%;object-fit:cover}
  .splash-title{font-size:28px;font-weight:800;margin:8px 0}
  .splash-sub{color:var(--muted);font-size:14px;margin:0}
  .btn{
    width:100%; border:none; padding:12px 14px; border-radius:12px;
    background:linear-gradient(135deg,var(--accent),var(--accent2));
    color:#001b12; font-weight:900; margin-top:14px;
    box-shadow:0 8px 18px rgba(57,255,180,.25);
  }
  .btn.secondary{
    background:var(--card2); color:var(--text);
    border:1px solid var(--line); box-shadow:none;
  }
  .input{
    width:100%; padding:12px 14px; border-radius:12px;
    border:1px solid var(--line); background:var(--card);
    color:var(--text); outline:none;
  }

  /* Topbar */
  header{
    position:sticky; top:0; z-index:50;
    background:linear-gradient(180deg, rgba(15,17,21,.95), rgba(15,17,21,.65));
    backdrop-filter: blur(10px);
    border-bottom:1px solid var(--line);
  }
  .head-inner{
    max-width:1100px;margin:0 auto;padding:12px 16px;
    display:flex;align-items:center;justify-content:space-between;gap:10px;
  }
  header img{
    width:40px;height:40px;border-radius:50%;object-fit:cover;cursor:pointer;
    border:1px solid var(--line);
  }
  .head-title{font-weight:800;letter-spacing:.3px}
  .cart-mini{cursor:pointer; font-weight:700; position:relative}
  .badge{
    position:absolute; top:-8px; right:-10px;
    background:#ff4444; color:#fff; font-size:11px; font-weight:800;
    width:20px;height:20px;border-radius:50%; display:grid;place-items:center;
    border:2px solid var(--bg);
  }

  /* Brand page */
  .brand-grid{
    display:grid; grid-template-columns:repeat(2,1fr); gap:12px; margin-top:10px;
  }
  @media(min-width:900px){.brand-grid{grid-template-columns:repeat(3,1fr)}}
  .brand-item{
    background:rgba(255,255,255,.04); border:1px solid var(--line);
    border-radius:14px; padding:16px; text-align:center;
    font-weight:700; font-size:18px; box-shadow:var(--shadow);
    transition:.15s ease;
  }
  .brand-item:hover{transform:translateY(-2px); border-color:rgba(57,255,180,.6)}

  /* Search sticky */
  .search-wrap{
    position:sticky; top:64px; z-index:40;
    background:linear-gradient(180deg, rgba(15,17,21,.98), rgba(15,17,21,.8));
    border-bottom:1px solid var(--line);
    margin:0 -16px 8px; padding:10px 16px;
  }
  .search{
    width:100%; padding:11px 12px; border-radius:12px; border:1px solid var(--line);
    background:var(--card); color:#fff; outline:none; font-size:15px;
  }

  /* Product list */
  #productList{display:grid; grid-template-columns:1fr; gap:12px}
  @media(min-width:900px){#productList{grid-template-columns:repeat(2,1fr)}}
  .product-card{
    display:flex; gap:12px; align-items:center;
    background:linear-gradient(180deg,var(--card),var(--card2));
    border:1px solid var(--line); border-radius:14px; padding:10px; box-shadow:var(--shadow);
  }
  .product-card img{
    width:110px;height:110px;border-radius:10px;object-fit:cover;flex-shrink:0;
    background:#0b0d12;border:1px solid var(--line);
  }
  .product-info{flex:1;min-width:0}
  .product-info h3{margin:0 0 4px;font-size:16px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
  .product-info small{color:var(--muted)}
  .add-btn{
    margin-top:8px; display:inline-block;
    background:rgba(57,255,180,.14); color:var(--accent);
    border:1px solid rgba(57,255,180,.35);
    padding:6px 10px;border-radius:8px;font-weight:800;font-size:13px;
  }

  /* Cart */
  .cart-item{
    background:rgba(255,255,255,.04); border:1px solid var(--line);
    padding:12px; margin:10px 0; border-radius:12px;
    display:flex; justify-content:space-between; gap:10px; align-items:center;
  }
  .qty-btn{
    padding:4px 9px; background:var(--accent); border-radius:6px; color:#001b12;
    font-weight:900; border:none;
  }
  .remove-btn{background:transparent;border:none;color:var(--danger);font-weight:700}
  .summary{
    background:rgba(255,255,255,.04); border:1px solid var(--line);
    border-radius:14px; padding:12px; margin-top:12px;
  }

  /* Modal opsi */
  #optionPopup{
    display:none; position:fixed; inset:0; background:rgba(0,0,0,.65);
    justify-content:center; align-items:center; padding:20px; z-index:99;
  }
  .inner-opt{
    background:var(--bg2); padding:16px; border-radius:14px; width:min(360px,100%);
    border:1px solid var(--line); box-shadow:var(--shadow);
  }
  .inner-opt select{
    width:100%; padding:10px; margin:7px 0; border-radius:8px; border:1px solid var(--line);
    background:var(--card); color:var(--text); outline:none;
  }

  /* Popup checkout */
  #popup{
    display:none; position:fixed; inset:0; background:rgba(0,0,0,.7);
    justify-content:center; align-items:center; padding:20px; z-index:100;
  }
  #popup .inner{
    background:var(--bg2); padding:16px; border-radius:14px; width:min(420px,100%);
    border:1px solid var(--line); box-shadow:var(--shadow);
  }

  /* Floating cart bar */
  .float-cart{
    position:fixed; left:0; right:0; bottom:0; z-index:60;
    background:linear-gradient(180deg, rgba(15,17,21,.1), rgba(15,17,21,.98));
    border-top:1px solid var(--line); padding:8px 12px;
  }
  .float-inner{
    max-width:1100px;margin:0 auto; background:rgba(255,255,255,.04);
    border:1px solid var(--line); border-radius:12px; padding:10px 12px;
    display:flex; justify-content:space-between; align-items:center; gap:10px;
  }
  .float-btn{
    border:none; background:linear-gradient(135deg,var(--accent),var(--accent2));
    color:#001b12; font-weight:900; padding:9px 12px; border-radius:10px;
  }
</style>
</head>
<body>

<!-- SPLASH -->
<section id="splash">
  <div class="splash-card">
    <div class="logo"><img src="img/lglixystore.png" alt="LIXY"/></div>
    <div class="splash-title">LIXY STORE</div>
    <p class="splash-sub">coffee & tea marketplace</p>
    <button class="btn" onclick="goName()">Mulai</button>
  </div>
</section>

<!-- NAME PAGE -->
<section id="namePage" class="page hidden">
  <div style="max-width:520px;margin:40px auto 0">
    <h2 style="margin:0 0 8px">Masukkan Nama Kamu</h2>
    <input id="buyerName" class="input" placeholder="Nama lengkap..." maxlength="24"/>
    <button class="btn" onclick="saveName()">Lanjut</button>
  </div>
</section>

<!-- BRAND PAGE -->
<section id="brandPage" class="page hidden">
  <header>
    <div class="head-inner">
      <img src="img/lglixystore.png" alt="logo">
      <div class="head-title" id="helloUser">LIXY Store</div>
      <div class="cart-mini" onclick="openCart()">ðŸ›’ Cart <span id="badge" class="badge hidden">0</span></div>
    </div>
  </header>

  <h2 style="margin-top:16px">Pilih Brand</h2>
  <div class="brand-grid">
    <div class="brand-item" onclick="openBrand('fore')">Fore</div>
    <div class="brand-item" onclick="openBrand('kenangan')">Kopi Kenangan</div>
    <div class="brand-item" onclick="openBrand('janjijiwa')">Janji Jiwa</div>
    <div class="brand-item" onclick="openBrand('tomoro')">Tomoro</div>
    <div class="brand-item" onclick="openBrand('chagee')">Chagee</div>
  </div>
</section>

<!-- PRODUCT PAGE -->
<section id="productPage" class="page hidden">
  <header>
    <div class="head-inner">
      <img src="img/lglixystore.png" alt="logo" onclick="backBrand()">
      <div class="head-title" id="brandTitle">Produk</div>
      <div class="cart-mini" onclick="openCart()">ðŸ›’ Cart <span id="badge2" class="badge hidden">0</span></div>
    </div>
  </header>

  <div style="display:flex;justify-content:space-between;align-items:center;gap:8px;margin-top:10px">
    <div style="color:var(--muted);font-size:14px">Hi, <span id="helloUser2"></span> ðŸ‘‹</div>
    <button class="btn secondary" style="width:auto" onclick="openBrand(currentBrandKey,true)">Refresh Menu</button>
  </div>

  <div class="search-wrap">
    <input id="searchInput" class="search" placeholder="Cari menu..." oninput="filterProducts(this.value)">
  </div>

  <div id="productList"></div>
</section>

<!-- CART PAGE -->
<section id="cartPage" class="page hidden">
  <header>
    <div class="head-inner">
      <img src="img/lglixystore.png" alt="logo" onclick="backProduct()">
      <div class="head-title">Keranjang</div>
      <div></div>
    </div>
  </header>

  <div id="cartItems" style="margin-top:10px"></div>

  <div class="summary">
    <label style="font-size:13px;color:var(--muted)">Outlet</label>
    <select id="outletSelect"></select>

    <label style="font-size:13px;color:var(--muted);margin-top:8px;display:block">Catatan</label>
    <textarea id="cartNotes" class="input" style="min-height:70px;resize:vertical" placeholder="Opsional..."></textarea>

    <h3>Total: <span id="totalPrice">Rp 0</span></h3>
    <button class="btn" onclick="openPopup()">Checkout</button>
    <button class="btn secondary" onclick="backProduct()">Tambah Menu</button>
  </div>
</section>

<!-- FLOAT CART -->
<div id="floatCart" class="float-cart hidden">
  <div class="float-inner">
    <div>
      <div style="font-size:13px"><b id="floatCount">0</b> item</div>
      <div style="font-weight:900" id="floatTotal">Rp 0</div>
    </div>
    <button class="float-btn" onclick="openCart()">Lihat Cart</button>
  </div>
</div>

<!-- POPUP OPSI -->
<div id="optionPopup">
  <div class="inner-opt">
    <h3 style="margin-top:0" id="optTitle">Pilih Opsi</h3>

    <label>Ice / Hot</label>
    <select id="optTemp">
      <option value="Iced">Iced</option>
      <option value="Hot">Hot</option>
    </select>

    <label>Gula</label>
    <select id="optSugar">
      <option value="Normal">Normal</option>
      <option value="Less Sugar">Less Sugar</option>
    </select>

    <label>Size</label>
    <select id="optSize">
      <option value="Small">Small</option>
      <option value="Large">Large</option>
    </select>

    <button class="btn" onclick="confirmOptions()">Tambah ke Keranjang</button>
    <button class="btn secondary" onclick="closeOptionPopup()">Batal</button>
  </div>
</div>

<!-- POPUP CHECKOUT -->
<div id="popup">
  <div class="inner">
    <h3>Konfirmasi Pesanan</h3>
    <pre id="popupText" style="white-space:pre-wrap; font-size:14px"></pre>
    <button class="btn" onclick="sendWA()">Benar</button>
    <button class="btn secondary" onclick="closePopup()" style="border-color:rgba(255,91,91,.6)">Tidak</button>
  </div>
</div>

<script>
/* =========================
   STATE
========================= */
const BRAND_MAP = {
  fore: "data/fore.json",
  kenangan: "data/kenangan.json",
  janjijiwa: "data/janjijiwa.json",
  tomoro: "data/tomoro.json",
  chagee: "data/chagee.json"
};

let allProducts = [];
let currentBrandKey = null;
let currentBrandData = null;

// cart persist
let cart = JSON.parse(localStorage.getItem("lixy_cart") || "[]");
let selectedProductIndex = null;

// auto-update trackers (no localStorage)
let lastBrandVersion = null;
let lastBrandHash = null;
let pollTimer = null;

/* =========================
   NAV PAGES
========================= */
const splash = document.getElementById("splash");
const namePage = document.getElementById("namePage");
const brandPage = document.getElementById("brandPage");
const productPage = document.getElementById("productPage");
const cartPage = document.getElementById("cartPage");

function showOnly(page){
  [namePage, brandPage, productPage, cartPage].forEach(p=>p.classList.add("hidden"));
  page.classList.remove("hidden");
}

window.onload = () => {
  const n = localStorage.getItem("buyerName");
  if(n){
    setUserName(n);
    splash.classList.add("hidden");
    showOnly(brandPage);
  }
};

function goName(){
  splash.classList.add("hidden");
  showOnly(namePage);
}

function saveName(){
  const v = buyerName.value.trim();
  if(!v) return alert("Nama tidak boleh kosong");
  localStorage.setItem("buyerName", v);
  setUserName(v);
  showOnly(brandPage);
}

function setUserName(v){
  helloUser.textContent  = "Belanja Yuk, " + v;
  helloUser2.textContent = v;
}

function backBrand(){
  stopPolling();
  showOnly(brandPage);
}

function backProduct(){
  showOnly(productPage);
}

/* =========================
   BRAND LOADER (AUTO UPDATE)
========================= */
async function openBrand(key, forceReload=false){
  currentBrandKey = key;
  showOnly(productPage);
  await loadBrand(key, forceReload);
  startPolling(); // auto update while on product page
}

async function loadBrand(brandKey, forceReload=false){
  // always fetch fresh (no local cache for products)
  const url = BRAND_MAP[brandKey];
  if(!url) return;

  try{
    const res = await fetch(url + "?v=" + Date.now(), { cache:"no-store" });
    if(!res.ok) throw new Error("HTTP " + res.status);
    const data = await res.json();

    // normalize schema (products / items)
    const normalized = normalizeBrandData(data, brandKey);

    // detect update
    const freshVersion = normalized.version || null;
    const freshHash = hashJSON(normalized.products);

    if(forceReload || freshVersion !== lastBrandVersion || freshHash !== lastBrandHash){
      currentBrandData = normalized;
      allProducts = normalized.products || [];
      lastBrandVersion = freshVersion;
      lastBrandHash = freshHash;

      document.getElementById("brandTitle").textContent = normalized.brand || brandKey;
      renderProducts(allProducts);
      fillOutletOptions();
    } else {
      // no change, do nothing
    }

  }catch(err){
    console.error("loadBrand error:", err);
    document.getElementById("productList").innerHTML =
      `<div style="color:var(--muted);padding:30px;text-align:center">
        Gagal load ${brandKey}. Pastikan file JSON ada & pakai Live Server.
      </div>`;
  }
}

function normalizeBrandData(raw, brandKey){
  // schema baru
  if(raw && Array.isArray(raw.products)){
    return {
      brand: raw.brand || brandKey,
      version: raw.version || null,
      outlets: raw.outlets || [],
      products: raw.products.map(p=>({
        ...p,
        brand: raw.brand || brandKey,
        brandKey,
        variants: p.variants || defaultVariants()
      }))
    };
  }
  // schema lama
  if(raw && Array.isArray(raw.items)){
    const brand = raw.brand || raw.items[0]?.brand || brandKey;
    return {
      brand,
      version: raw.version || null,
      outlets: raw.outlets || [],
      products: raw.items.map((it, idx)=>({
        id: (brandKey+"-"+idx),
        name: it.name || "Untitled",
        price: Number(it.price)||0,
        image: it.image || "",
        description: it.description || "",
        category: it.category || "Coffee",
        variants: defaultVariants(),
        brand, brandKey
      }))
    };
  }
  return { brand: brandKey, version:null, outlets:[], products:[] };
}

function defaultVariants(){
  return {
    temperature:["Iced","Hot"],
    sugar:["Normal","Less Sugar"],
    size:["Small","Large"]
  };
}

function startPolling(){
  stopPolling();
  pollTimer = setInterval(()=>{
    if(currentBrandKey && !productPage.classList.contains("hidden")){
      loadBrand(currentBrandKey, false); // check update silently
    }
  }, 20000); // tiap 20 detik cek update (enteng)
}

function stopPolling(){
  if(pollTimer){ clearInterval(pollTimer); pollTimer=null; }
}

function hashJSON(obj){
  try{
    const s = JSON.stringify(obj);
    let h=0; for(let i=0;i<s.length;i++){ h=((h<<5)-h)+s.charCodeAt(i); h|=0; }
    return h;
  }catch(e){ return Math.random(); }
}

/* =========================
   PRODUCTS
========================= */
function renderProducts(list){
  const productListEl = document.getElementById("productList");
  if(!list.length){
    productListEl.innerHTML = `<div style="color:var(--muted);padding:30px;text-align:center">Menu kosong.</div>`;
    return;
  }
  productListEl.innerHTML = "";
  list.forEach((p, i)=>{
    productListEl.innerHTML += `
      <div class="product-card">
        <img loading="lazy" decoding="async" src="${p.image}" alt="${escapeHtml(p.name)}"
          onerror="this.src=''; this.style.background='#111'; this.alt='no image'">
        <div class="product-info">
          <h3>${escapeHtml(p.name)}</h3>
          <small>Rp ${Number(p.price).toLocaleString("id-ID")}</small>
          <div class="add-btn" onclick="addCart(${i})">+ Keranjang</div>
        </div>
      </div>
    `;
  });
}

function filterProducts(q){
  q = (q||"").toLowerCase();
  const filtered = allProducts.filter(x => (x.name||"").toLowerCase().includes(q));
  renderProducts(filtered);
}

function escapeHtml(s=""){
  return s.replace(/[&<>'"]/g, c=>({ "&":"&amp;","<":"&lt;",">":"&gt;","'":"&#39;",'"':"&quot;" }[c]));
}

/* =========================
   CART + OPTION
========================= */
function addCart(i){
  selectedProductIndex = i;
  const p = allProducts[i];
  optTitle.textContent = p.name;
  // set default based on variants if exist
  setSelectOptions("optTemp", p.variants?.temperature);
  setSelectOptions("optSugar", p.variants?.sugar);
  setSelectOptions("optSize", p.variants?.size);
  optionPopup.style.display="flex";
}

function setSelectOptions(id, opts){
  const sel = document.getElementById(id);
  const arr = Array.isArray(opts) && opts.length ? opts : sel.querySelectorAll("option")?.length ? null : [];
  if(arr){
    sel.innerHTML = arr.map(o=>`<option value="${o}">${o}</option>`).join("");
  }
}

function closeOptionPopup(){ optionPopup.style.display="none"; }

function confirmOptions(){
  const temp  = optTemp.value;
  const sugar = optSugar.value;
  const size  = optSize.value;

  const item = allProducts[selectedProductIndex];
  if(!item) return;

  const key = item.id + "|" + temp + "|" + sugar + "|" + size;

  const exist = cart.find(c => c.key === key);
  if(exist) exist.qty++;
  else cart.push({
    key,
    ...item,
    qty:1,
    temp,sugar,size
  });

  persistCart();
  updateBadge();
  closeOptionPopup();
}

function persistCart(){
  localStorage.setItem("lixy_cart", JSON.stringify(cart));
}

function updateBadge(){
  const qty = cart.reduce((a,b)=>a+b.qty,0);
  badge.textContent = qty;
  badge2.textContent = qty;
  badge.classList.toggle("hidden", qty===0);
  badge2.classList.toggle("hidden", qty===0);

  floatCount.textContent = qty;
  floatTotal.textContent = toRp(cart.reduce((a,b)=>a + b.qty*b.price,0));
  floatCart.classList.toggle("hidden", qty===0);
}

function openCart(){
  stopPolling();
  showOnly(cartPage);
  loadCart();
}

function loadCart(){
  cartItems.innerHTML = "";
  if(cart.length===0){
    cartItems.innerHTML = `<div style="color:var(--muted);padding:25px;text-align:center">Cart kosong.</div>`;
    totalPrice.textContent="Rp 0";
    fillOutletOptions();
    return;
  }

  cart.forEach((c,i)=>{
    cartItems.innerHTML += `
      <div class="cart-item">
        <div style="flex:1;min-width:0">
          <strong>${escapeHtml(c.name)}</strong><br>
          <small style="color:var(--muted)">
            ${c.brand} â€¢ ${c.temp}, ${c.sugar}, ${c.size}
          </small><br>
          Rp ${(c.price*c.qty).toLocaleString("id-ID")}
        </div>
        <div style="white-space:nowrap">
          <button class="qty-btn" onclick="decQty(${i})">-</button>
          <b style="margin:0 6px">${c.qty}</b>
          <button class="qty-btn" onclick="incQty(${i})">+</button>
          <button class="remove-btn" onclick="removeItem(${i})">hapus</button>
        </div>
      </div>
    `;
  });

  updateTotal();
}

function incQty(i){ cart[i].qty++; persistCart(); loadCart(); updateBadge(); }
function decQty(i){
  cart[i].qty--; 
  if(cart[i].qty<=0) cart.splice(i,1);
  persistCart(); loadCart(); updateBadge();
}
function removeItem(i){ cart.splice(i,1); persistCart(); loadCart(); updateBadge(); }

function updateTotal(){
  const total = cart.reduce((a,b)=>a + b.qty*b.price,0);
  totalPrice.textContent = toRp(total);
}

function toRp(n){
  n=Number(n)||0;
  return "Rp " + n.toLocaleString("id-ID");
}

/* =========================
   OUTLETS
========================= */
function fillOutletOptions(){
  const outlets = currentBrandData?.outlets?.length
    ? currentBrandData.outlets
    : ["LIXY Cilegon","LIXY Serang","LIXY Anyer"];

  const saved = localStorage.getItem("lixy_outlet") || outlets[0];
  outletSelect.innerHTML = outlets.map(o=>`<option ${o===saved?"selected":""}>${o}</option>`).join("");
  outletSelect.onchange=()=>localStorage.setItem("lixy_outlet", outletSelect.value);
}

/* =========================
   CHECKOUT
========================= */
function openPopup(){
  if(cart.length===0) return alert("Cart kosong");
  const name = localStorage.getItem("buyerName") || "-";
  const outlet = outletSelect.value;
  const notes = cartNotes.value.trim();

  const listTxt = cart.map(c =>
    `${c.qty}x ${c.name} (${c.temp}, ${c.sugar}, ${c.size}) - ${toRp(c.qty*c.price)}`
  ).join("\n");

  popupText.textContent =
`Nama: ${name}
Outlet: ${outlet}

Pesanan:
${listTxt}

Total: ${toRp(cart.reduce((a,b)=>a+b.qty*b.price,0))}
${notes?("\nCatatan: "+notes):""}`;

  popup.style.display="flex";
}

function closePopup(){ popup.style.display="none"; }

function sendWA(){
  const name = localStorage.getItem("buyerName") || "-";
  const outlet = outletSelect.value;
  const notes = cartNotes.value.trim();
  const listTxt = cart.map(c =>
    `${c.qty}x ${c.name} (${c.temp}, ${c.sugar}, ${c.size}) - ${toRp(c.qty*c.price)}`
  ).join("%0A");

  let msg =
`Nama: ${name}
Outlet: ${outlet}

Pesanan:
${listTxt}

Total: ${toRp(cart.reduce((a,b)=>a+b.qty*b.price,0))}
${notes?("%0ACatatan: "+encodeURIComponent(notes)):""}`.replace(/\n/g,"%0A");

  // ganti nomor WA tujuan
  window.open(`https://wa.me/6281290306599?text=${msg}`, "_blank");
}

/* init badge at start */
updateBadge();
</script>

</body>
</html>
